# Notion 검수 데이터베이스 템플릿

## Database 이름
**KICE Problem Review**

---

## 속성 (20개)

### 1. 기본 식별 정보

| 속성명 | 타입 | 설명 | DB 매핑 |
|--------|------|------|---------|
| **문제 ID** | 제목 (Title) | 문제 고유 ID | `problem_id` |
| **연도** | 숫자 (Number) | 연도 (2024~2026) | `year` |
| **시험** | 선택 (Select) | 시험 유형 | `exam` |
| **문항번호** | 숫자 (Number) | 문항 번호 (1~30) | `question_no` |

**시험 Select 옵션:**
- CSAT (수능)
- KICE6 (6월 모의평가)
- KICE9 (9월 모의평가)

---

### 2. 문제 정보

| 속성명 | 타입 | 설명 | DB 매핑 |
|--------|------|------|---------|
| **배점** | 숫자 (Number) | 2, 3, 4점 | `score` |
| **난이도** | 숫자 (Number) | 1~5 | `difficulty` |
| **과목** | 선택 (Select) | 수학1/수학2 | `subject` |
| **단원** | 선택 (Select) | 세부 단원 | `unit` |
| **정답유형** | 선택 (Select) | 객관식/주관식 | `answer_type` |

**과목 옵션:** Math1, Math2

**단원 옵션:**
- 수학1: 지수로그, 삼각함수, 수열
- 수학2: 함수의극한연속, 미분, 적분
- 선택: 확률과통계, 미적분, 기하

**정답유형 옵션:** multiple_choice (객관식), short_answer (주관식)

---

### 3. 콘텐츠 (리치 텍스트)

| 속성명 | 타입 | 설명 | DB 매핑 |
|--------|------|------|---------|
| **정답** | 리치 텍스트 | 확정 정답 | `answer_verified` |
| **출제의도** | 리치 텍스트 | 출제 의도 | `intent_1` |
| **풀이** | 리치 텍스트 | 상세 풀이 | `solution` |
| **힌트1** | 리치 텍스트 | 개념 방향 | hints stage=1 |
| **힌트2** | 리치 텍스트 | 핵심 전환 | hints stage=2 |
| **힌트3** | 리치 텍스트 | 결정적 한 줄 | hints stage=3 |
| **검수자** | 리치 텍스트 | 검수 담당자 이름 | - |

---

### 4. 링크

| 속성명 | 타입 | 설명 | DB 매핑 |
|--------|------|------|---------|
| **원본링크** | URL | 원본 PDF 링크 | `source_ref` |
| **이미지폴더** | URL | Supabase 이미지 URL | `problem_image_url` |

---

### 5. 상태 관리

| 속성명 | 타입 | 설명 |
|--------|------|------|
| **상태** | 선택 (Select) | 검수 진행 상태 |
| **검수일** | 날짜 (Date) | 검수 완료일 |

**상태 옵션 (색상):**
- 검수 필요 (보라)
- 수정 필요 (빨강)
- 보류 (회색)
- 검수 완료 (초록)
- 발송 준비 (파랑)

---

## 검수 페이지 본문 구성

`sync_to_notion.py` 실행 시 각 문제 페이지에 자동 생성되는 블록:

```
📋 문제 정보 (Callout)
    과목: Math2 | 단원: 미분 | 배점: 3점 | 유형: 객관식 | 정답: 3

🖼️ 문제 이미지 (Image block)
    Supabase Storage URL에서 로드

📝 풀이 (Toggle Heading)
    ▶ 클릭하면 상세 풀이 표시
    (2000자 초과 시 자동 분할)

💡 힌트 1단계: 개념 방향 (Toggle Heading)
    ▶ 파란색 Callout으로 표시

🔑 힌트 2단계: 핵심 전환 (Toggle Heading)
    ▶ 노란색 Callout으로 표시

🎯 힌트 3단계: 결정적 한 줄 (Toggle Heading)
    ▶ 빨간색 Callout으로 표시

📌 출제 의도 (Toggle Heading)
    ▶ 클릭하면 출제 의도 표시

✅ 검수 체크리스트 (Callout)
    □ 문제 이미지 선명도 확인
    □ 정답 정확성 확인
    □ 배점 확인
    □ 정답유형 확인 (객관식/주관식)
    □ 풀이 정확성 및 완성도
    □ 힌트 3단계 품질 확인
    □ 과목/단원 분류 확인
    □ 난이도 적절성 확인
```

---

## Views (뷰) 구성

### 1. Board: 검수 현황 (칸반)

**Group by:** 상태
**Sort:** 연도 DESC, 문항번호 ASC

```
┌─────────────┬─────────────┬─────────────┬─────────────┬──────────────┐
│ 검수 필요    │ 수정 필요    │ 보류        │ 검수 완료    │ 발송 준비     │
├─────────────┼─────────────┼─────────────┼─────────────┼──────────────┤
│ 2026_Q15    │             │             │ 2026_Q01    │              │
│ 2026_Q14    │             │             │ 2026_Q02    │              │
│ ...         │             │             │ ...         │              │
└─────────────┴─────────────┴─────────────┴─────────────┴──────────────┘
```

### 2. Table: 연도별 (By Year)

**Group by:** 연도
**Sort:** 시험 ASC, 문항번호 ASC
**Columns:** 문제 ID, 시험, 문항번호, 과목, 단원, 배점, 상태

### 3. Table: 단원별 (By Unit)

**Group by:** 단원
**Sort:** 연도 DESC, 문항번호 ASC
**Columns:** 문제 ID, 연도, 시험, 배점, 정답, 상태

### 4. Gallery: 이미지 갤러리

**Card preview:** 문제 이미지
**Properties shown:** 문제 ID, 연도, 배점, 상태

---

## 동기화 CLI

```bash
# 전체 동기화
python sync_to_notion.py

# 연도별
python sync_to_notion.py --year 2026

# 시험별
python sync_to_notion.py --year 2026 --exam CSAT

# 단일 문제
python sync_to_notion.py --problem-id 2026_CSAT_Q01

# 상태별
python sync_to_notion.py --status needs_review

# 미리보기 (Notion 호출 없음)
python sync_to_notion.py --dry-run

# 확인 없이 실행
python sync_to_notion.py --yes
```

### 동기화 특징
- Rate limiting: 문제당 1.5초 간격 (Notion API ~3 req/sec)
- Exponential backoff 자동 재시도 (최대 3회)
- Circuit breaker: 5회 연속 실패 시 자동 중단
- ETA 표시: 남은 시간 실시간 계산
- Upsert: 기존 페이지 있으면 업데이트, 없으면 생성

---

## 검수 워크플로우

### Step 1: Notion DB에서 "검수 필요" 문제 선택
### Step 2: 문제 정보 검토
1. 문제 이미지 선명도 확인
2. 정답/배점/정답유형 확인
3. 과목/단원 분류 확인

### Step 3: 풀이/힌트 검토
1. 풀이 토글 열어 정확성 확인
2. 힌트 3단계 품질 확인
3. 출제 의도 확인

### Step 4: 완료
1. 체크리스트 8항목 완료
2. 상태 → "검수 완료"
3. 검수자 이름 + 검수일 기입

---

## 현재 DB 현황 (66문제)

| 연도 | 시험 | 문제수 | 이미지 | 힌트 |
|------|------|--------|--------|------|
| 2024 | CSAT | 22 | 22 (100%) | 66 |
| 2025 | CSAT | 22 | 22 (100%) | 66 |
| 2026 | CSAT | 22 | 22 (100%) | 66 |
| **합계** | | **66** | **66 (100%)** | **198** |

---

**마지막 업데이트**: 2026-02-08
